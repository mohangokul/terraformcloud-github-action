name: 'Terraform'
on:                               
  push:                                 
    branches:                                 
    - main                               
  pull_request:
                                                       
env:                                   
  TF_CLOUD_ORGANIZATIOND: "mohanrajdevarasu"
  TF_API_TOKEN: ${{ secrets.TF_API_TOKEN }}
  TF_WORKSPACE: "mohan-github-action"

jobs:                               
  terraform:                                 
    name: 'Terraform'                                 
    runs-on: ubuntu-latest                             
    steps:                             
        # Checkout the repository to the GitHub Actions runner        
        - name: Checkout                                   
          uses: actions/checkout@v3
    # Runs a single command using the runners shell     
        - name: 'Terraform init' 
          id: init                                   
          run: |                                     
            terraform init                           

        - name: Set up Terraform
          uses: hashicorp/setup-terraform@v1
        
        - name: 'Terraform plan'                                   
          id: plan                                   
          run: |                                     
            terraform plan                 
                                        
        - name: 'Terraform apply' 
          id: apply            
          run: |    
            terraform apply -auto-approve
